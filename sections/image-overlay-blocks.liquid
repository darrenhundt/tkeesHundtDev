<div id="section-id-{{ section.id }}" class="section-image-overlay-blocks" data-section-type="image-overlay-blocks">
  {% style %}
    #section-id-{{ section.id }} .image-overlay-blocks-container {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    @media (min-width: 1001px) {
      #section-id-{{ section.id }} .image-overlay-blocks-container {
        flex-direction: row;
        gap: 10px;
      }
      #section-id-{{ section.id }} .image-overlay-block {
        flex: 1;
      }
    }
  {% endstyle %}
  
  {%- unless section.settings.full_width -%}
    <div class="container container--not-mobile fully-spaced-row--medium fully-spaced-row--not-mobile">
  {%- endunless -%}
  
  <div id="comingsoon" class="image-overlay-blocks-container">
  {% for block in section.blocks %}
    {%- liquid
      assign show_overlay_content = false
      if block.settings.heading != blank or block.settings.custom_html != blank or block.settings.button_label != blank or block.settings.accent_image != blank
        assign show_overlay_content = true
      endif
    -%}

    <div id="block-id-{{ block.id }}" class="image-overlay-block" {{ block.shopify_attributes }}>
      {% style %}
        #block-id-{{ block.id }} {
          {% if block.settings.height == 'fixed' %}
            height: {{ block.settings.height_mobile }}vw;
          {% endif %}
          {% if block.settings.background_image != blank %}
            background-image: url('{{ block.settings.background_image | img_url: '2048x2048' }}');
            background-size: cover;
            background-position: {{ block.settings.image_position }};
            background-repeat: no-repeat;
          {% endif %}
        }
        @media (min-width: 1001px) {
          #block-id-{{ block.id }} {
            {% if block.settings.height == 'fixed' %}
              height: {{ block.settings.height_desktop_vw }}vw;
            {% endif %}
            {% if block.settings.background_image != blank %}
              background-position: {{ block.settings.image_position }};
            {% endif %}
          }
        }
        @media (max-width: 1000px) {
          #block-id-{{ block.id }} {
            {% if block.settings.mobile_image != blank %}
              background-image: url('{{ block.settings.mobile_image | img_url: '1024x1024' }}');
              background-position: {{ block.settings.mobile_image_position }};
            {% elsif block.settings.background_image != blank %}
              background-image: url('{{ block.settings.background_image | img_url: '1024x1024' }}');
            {% endif %}
          }
        }
        
        #block-id-{{ block.id }} .overlay-content-box {
          position: absolute;
          left: {{ block.settings.position_x_mobile | default: block.settings.position_x }}%;
          top: {{ block.settings.position_y_mobile | default: block.settings.position_y }}%;
          width: {{ block.settings.content_width_mobile | default: block.settings.content_width }}%;
          transform: translate(0%, -50%);
        }
        
        @media (min-width: 1001px) {
          #block-id-{{ block.id }} .overlay-content-box {
            left: {{ block.settings.position_x }}%;
            top: {{ block.settings.position_y }}%;
            width: {{ block.settings.content_width }}%;
          }
        }
        
        #block-id-{{ block.id }} .overlay-content-box__heading {
          font-size: {{ block.settings.heading_size_mobile }}px;
        }
        
        @media (min-width: 768px) {
          #block-id-{{ block.id }} .overlay-content-box__heading {
            font-size: {{ block.settings.heading_size }}px;
          }
        }
        
        /* Overlay text alignment () */
        {% if block.settings.overlay_text_alignment == 'left' %}
        #block-id-{{ block.id }} .overlay-text.overlay-text--for-banner.image-overlay__over.overlay-text--align-left {
          text-align: left;
        }
        #block-id-{{ block.id }} .overlay-text.overlay-text--for-banner.image-overlay__over.overlay-text--align-left .overlay-content-box__button-row {
          justify-content: flex-start;
        }
        {% elsif block.settings.overlay_text_alignment == 'center' %}
        #block-id-{{ block.id }} .overlay-text.overlay-text--for-banner.image-overlay__over.overlay-text--align-center {
          text-align: center;
        }
        #block-id-{{ block.id }} .overlay-text.overlay-text--for-banner.image-overlay__over.overlay-text--align-center .overlay-content-box__button-row {
          justify-content: center;
        }
        {% elsif block.settings.overlay_text_alignment == 'right' %}
        #block-id-{{ block.id }} .overlay-text.overlay-text--for-banner.image-overlay__over.overlay-text--align-right {
          text-align: right;
        }
        #block-id-{{ block.id }} .overlay-text.overlay-text--for-banner.image-overlay__over.overlay-text--align-right .overlay-content-box__button-row {
          justify-content: flex-end;
        }
        {% endif %}

        {% if block.settings.button_label != blank %}
          #block-id-{{ block.id }} .overlay-text__button {
            {% if block.settings.button_background_color != blank %}
              {% if block.settings.button_background_color == 'transparent' or block.settings.button_background_color == 'rgba(0,0,0,0)' %}
                background-color: transparent !important;
              {% else %}
                background-color: {{ block.settings.button_background_color }} !important;
              {% endif %}
            {% endif %}
            {% if block.settings.button_text_color != blank %}
              color: {{ block.settings.button_text_color }};
            {% endif %}
            {% if block.settings.button_border_color != blank %}
              border-color: {{ block.settings.button_border_color }}!important;
              border-width: 1px!important;
              border-style: solid!important;
            {% endif %}
            padding-left: {{ block.settings.button_padding_mobile_vw | default: 8 }}vw;
            padding-right: {{ block.settings.button_padding_mobile_vw | default: 8 }}vw;
            font-weight: bold;
          }
          @media (min-width: 1001px) {
            #block-id-{{ block.id }} .overlay-text__button {
              padding-left: 40px;
              padding-right: 40px;
            }
          }
        {% endif %}
      {% endstyle %}

      <div class="height--{{ block.settings.height }} image-overlay image-overlay--bg-{{ block.settings.overlay_style }}">
        {%- if block.settings.background_image == blank -%}
          <div
            class="placeholder-image placeholder--banner{% if show_overlay_content %} dark{% endif %}{% if block.settings.height == 'fixed' %} fixed-height-item{% endif %}"
            {% if block.settings.height == 'adapt' %}
              style="padding-top: 50%"
            {% endif %}
          >
            {% capture current %}{% cycle 1, 2 %}{% endcapture %}
            {{ 'lifestyle-' | append: current | placeholder_svg_tag: 'placeholder-svg' }}
          </div>
        {%- else -%}
          <div class="rimage-background-wrapper lazyload--placeholder {% if block.settings.mobile_image != blank %}desktop-only{% endif %}">
            <div
              class="rimage-outer-wrapper rimage-background lazyload fade-in{% if block.settings.height == 'fixed' %} fixed-height-item{% endif %}"
              data-bgset="{% render 'bgset', image: block.settings.background_image %}"
              data-sizes="auto"
              data-parent-fit="cover"
              style="background-position: {{ block.settings.image_position }}"
            >
              {%- if block.settings.height == 'adapt' -%}
                {%- assign aspect_ratio = block.settings.background_image.aspect_ratio | default: 2.0 -%}
                <div class="rimage-wrapper" style="padding-top:{{ 1 | divided_by: aspect_ratio | times: 100 }}%"></div>
              {%- endif -%}
              <noscript>
                <div
                  class="rimage-wrapper"
                  style="padding-top:{{ 1 | divided_by: block.settings.background_image.aspect_ratio | times: 100 }}%"
                >
                  <img
                    src="{{ block.settings.background_image | img_url: '1024x1024' }}"
                    alt="{{ block.settings.background_image.alt | escape }}"
                    class="rimage__image"
                  >
                </div>
              </noscript>
            </div>
          </div>

          {% if block.settings.mobile_image != blank %}
            <div
              class="rimage-outer-wrapper rimage-background lazyload mobile-only fade-in{% if block.settings.height == 'fixed' %} fixed-height-item{% endif %}"
              data-bgset="{% render 'bgset', image: block.settings.mobile_image %}"
              data-sizes="auto"
              data-parent-fit="cover"
              style="background-position: {{ block.settings.mobile_image_position }}"
            >
              {%- if block.settings.height == 'adapt' -%}
                {%- assign aspect_ratio = block.settings.mobile_image.aspect_ratio | default: 2.0 -%}
                <div
                  class="rimage-wrapper"
                  style="padding-top:{{ 1 | divided_by: aspect_ratio | times: 100 }}%"
                ></div>
              {%- endif -%}
              <noscript>
                <div
                  class="rimage-wrapper"
                  style="padding-top:{{ 1 | divided_by: block.settings.mobile_image.aspect_ratio | times: 100 }}%"
                >
                  <img
                    src="{{ block.settings.mobile_image | img_url: '1024x1024' }}"
                    alt="{{ block.settings.mobile_image.alt | escape }}"
                    class="rimage__image"
                  >
                </div>
              </noscript>
            </div>
          {% endif %}
        {%- endif -%}

        {%- if show_overlay_content -%}
          <div class="overlay-text overlay-text--for-banner image-overlay__over {% if block.settings.overlay_text_alignment != blank %}overlay-text--align-{{ block.settings.overlay_text_alignment }}{% endif %}">
            <div class="overlay-content-box">
              {%- if block.settings.accent_image != blank -%}
                <div class="overlay-content-box__accent-image">
                  <img
                    src="{{ block.settings.accent_image | img_url: '300x300' }}"
                    alt="{{ block.settings.accent_image.alt | escape }}"
                    loading="lazy"
                  >
                </div>
              {%- endif -%}
              
              {%- if block.settings.heading != blank -%}
                <h2 class="overlay-content-box__heading h1-style">
                  {{ block.settings.heading | escape }}
                </h2>
              {%- endif -%}
              
              {%- if block.settings.custom_html != blank -%}
                <div class="overlay-content-box__custom-html">
                  {{ block.settings.custom_html }}
                </div>
              {%- endif -%}
              
              {%- if block.settings.button_label != blank -%}
                <div class="overlay-content-box__button-row">
                  <a
                    class="overlay-text__button button altcolour {% if block.settings.button_style == 'nudes' %}nudes-button{% elsif block.settings.button_style == 'eos24' %}eos24-button{% elsif block.settings.button_style == 'black_on_white' %}black-on-white-button{% endif %}"
                    href="{{ block.settings.button_link }}"
                  >
                    {{ block.settings.button_label | escape }}
                  </a>
                </div>
              {%- endif -%}
            </div>
          </div>
        {%- endif -%}
      </div>
    </div>
  {% endfor %}
  </div>

  {%- unless section.settings.full_width -%}</div>{%- endunless -%}
</div>

{% schema %}
{
  "name": "Image Overlay Blocks",
  "class": "section-image-overlay-blocks",
  "settings": [
    {
      "id": "full_width",
      "type": "checkbox",
      "label": "Full page width",
      "default": true
    }
  ],
  "blocks": [
    {
      "type": "overlay_block",
      "name": "Overlay Block",
      "settings": [
        {
          "type": "header",
          "content": "Background Image"
        },
        {
          "type": "image_picker",
          "id": "background_image",
          "label": "Background image",
          "info": "2048 x 1024px recommended"
        },
        {
          "type": "image_picker",
          "id": "mobile_image",
          "label": "Mobile image",
          "info": "1024px x 1024px recommended"
        },
        {
          "type": "select",
          "id": "image_position",
          "label": "Image alignment",
          "info": "Used to keep the subject of your image in view",
          "default": "center center",
          "options": [
            {
              "value": "top left",
              "label": "Top left"
            },
            {
              "value": "top center",
              "label": "Top center"
            },
            {
              "value": "top right",
              "label": "Top right"
            },
            {
              "value": "center left",
              "label": "Middle left"
            },
            {
              "value": "center center",
              "label": "Middle center"
            },
            {
              "value": "center right",
              "label": "Middle right"
            },
            {
              "value": "bottom left",
              "label": "Bottom left"
            },
            {
              "value": "bottom center",
              "label": "Bottom center"
            },
            {
              "value": "bottom right",
              "label": "Bottom right"
            }
          ]
        },
        {
          "type": "select",
          "id": "mobile_image_position",
          "label": "Mobile image alignment",
          "options": [
            {
              "value": "left top",
              "label": "Top left"
            },
            {
              "value": "center top",
              "label": "Top center"
            },
            {
              "value": "right top",
              "label": "Top right"
            },
            {
              "value": "left center",
              "label": "Middle left"
            },
            {
              "value": "center center",
              "label": "Middle center"
            },
            {
              "value": "right center",
              "label": "Middle right"
            },
            {
              "value": "left bottom",
              "label": "Bottom left"
            },
            {
              "value": "center bottom",
              "label": "Bottom center"
            },
            {
              "value": "right bottom",
              "label": "Bottom right"
            }
          ],
          "default": "center center"
        },
        {
          "type": "radio",
          "id": "height",
          "label": "Image height",
          "options": [
            {
              "value": "adapt",
              "label": "Natural"
            },
            {
              "value": "full",
              "label": "Full screen"
            },
            {
              "value": "fixed",
              "label": "Fixed height"
            }
          ],
          "default": "fixed"
        },
        {
          "type": "range",
          "id": "height_desktop_vw",
          "min": 30,
          "max": 200,
          "step": 5,
          "unit": "vw",
          "label": "Desktop fixed height",
          "default": 50
        },
        {
          "type": "range",
          "id": "height_mobile",
          "min": 30,
          "max": 200,
          "step": 10,
          "unit": "vw",
          "label": "Mobile fixed height",
          "default": 100
        },
        {
          "id": "overlay_style",
          "type": "select",
          "label": "Overlay style",
          "default": "shadow",
          "options": [
            {
              "value": "full",
              "label": "Tint"
            },
            {
              "value": "box",
              "label": "Box"
            },
            {
              "value": "shadow",
              "label": "Text shadow"
            },
            {
              "value": "full image-overlay--bg-shadow",
              "label": "Text shadow and tint"
            },
            {
              "value": "no_background",
              "label": "No background"
            }
          ]
        },
        {
          "type": "header",
          "content": "Overlay Content"
        },
        {
          "type": "image_picker",
          "id": "accent_image",
          "label": "Accent image"
        },
        {
          "type": "text",
          "id": "heading",
          "label": "Heading"
        },
        {
          "type": "range",
          "id": "heading_size",
          "min": 20,
          "max": 150,
          "step": 2,
          "unit": "px",
          "label": "Desktop heading size",
          "default": 84
        },
        {
          "type": "range",
          "id": "heading_size_mobile",
          "min": 20,
          "max": 150,
          "step": 2,
          "unit": "px",
          "label": "Mobile heading size",
          "default": 46
        },
        {
          "type": "html",
          "id": "custom_html",
          "label": "Custom HTML (Klaviyo form)",
          "info": "Add your Klaviyo form embed code here"
        },
        {
          "type": "text",
          "id": "button_label",
          "label": "Button label"
        },
        {
          "type": "url",
          "id": "button_link",
          "label": "Button link"
        },
        {
          "type": "select",
          "id": "button_style",
          "label": "Button style",
          "options": [
            {
              "value": "default",
              "label": "Default"
            },
            {
              "value": "black_on_white",
              "label": "Black on white"
            },
            {
              "value": "nudes",
              "label": "Nudes"
            },
            {
              "value": "eos24",
              "label": "EOS 24"
            }
          ],
          "default": "default"
        },
        {
          "type": "color",
          "id": "button_background_color",
          "label": "Button background color"
        },
        {
          "type": "color",
          "id": "button_text_color",
          "label": "Button text color"
        },
        {
          "type": "color",
          "id": "button_border_color",
          "label": "Button border color"
        },
        {
          "type": "range",
          "id": "button_padding_mobile_vw",
          "min": 1,
          "max": 20,
          "step": 0.5,
          "unit": "vw",
          "label": "Button padding (mobile)",
          "info": "Left and right padding in vw units for screens 1000px and below",
          "default": 5
        },
        {
          "type": "select",
          "id": "overlay_text_alignment",
          "label": "Overlay text alignment",
          "info": "Controls text alignment for overlay text content",
          "options": [
            {
              "value": "",
              "label": "Default"
            },
            {
              "value": "left",
              "label": "Left"
            },
            {
              "value": "center",
              "label": "Center"
            },
            {
              "value": "right",
              "label": "Right"
            }
          ],
          "default": ""
        },
        {
          "type": "header",
          "content": "Content Position (Desktop)"
        },
        {
          "type": "range",
          "id": "position_x",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "%",
          "label": "Horizontal position (desktop)",
          "info": "0% = left, 50% = center, 100% = right. Applies to screens 1001px and above.",
          "default": 50
        },
        {
          "type": "range",
          "id": "position_y",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "%",
          "label": "Vertical position (desktop)",
          "info": "0% = top, 50% = middle, 100% = bottom. Applies to screens 1001px and above.",
          "default": 50
        },
        {
          "type": "range",
          "id": "content_width",
          "min": 10,
          "max": 100,
          "step": 5,
          "unit": "%",
          "label": "Content box width (desktop)",
          "info": "Applies to screens 1001px and above.",
          "default": 50
        },
        {
          "type": "header",
          "content": "Content Position (Mobile)"
        },
        {
          "type": "range",
          "id": "position_x_mobile",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "%",
          "label": "Horizontal position (mobile)",
          "info": "0% = left, 50% = center, 100% = right. Applies to screens 1000px and below.",
          "default": 50
        },
        {
          "type": "range",
          "id": "position_y_mobile",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "%",
          "label": "Vertical position (mobile)",
          "info": "0% = top, 50% = middle, 100% = bottom. Applies to screens 1000px and below.",
          "default": 50
        },
        {
          "type": "range",
          "id": "content_width_mobile",
          "min": 10,
          "max": 100,
          "step": 5,
          "unit": "%",
          "label": "Content box width (mobile)",
          "info": "Applies to screens 1000px and below.",
          "default": 50
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Image Overlay Blocks",
      "blocks": [
        {
          "type": "overlay_block"
        }
      ]
    }
  ]
}
{% endschema %}

